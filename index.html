<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dyskretna Intencja</title>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
        }
        
        :root {
            --bg: #9fc6e2;
            --bg2: #cfe8f8;
            --navy: #1e3a8a;
            --quote-grad-start: #3b5998;
            --quote-grad-end: #5a8dee;
            --point-blue: #2b7bd6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--bg);
            min-height: 100%;
            padding: 20px;
            color: var(--navy);
            overflow-x: hidden;
        }

        .back-arrow {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 10000;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(6,21,52,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideInLeft 0.8s ease-out;
        }

        .back-arrow:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(6,21,52,0.25);
        }

        .back-arrow svg {
            width: 24px;
            height: 24px;
            fill: var(--navy);
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 80px 15px 20px 15px;
            animation: slideInRight 1s ease-out;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px 20px;
            position: relative;
        }

        .title {
            font-family: 'Pacifico', cursive;
            font-size: 1.8rem;
            color: var(--navy);
            margin-bottom: 6px;
            text-shadow: 0 2px 4px rgba(6,21,52,0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .title-arrow {
            width: 20px;
            height: 20px;
            fill: var(--navy);
            opacity: 0.7;
        }

        .subtitle {
            font-size: 0.85rem;
            color: var(--navy);
            opacity: 0.7;
            font-weight: 400;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 
                0 8px 32px rgba(6,21,52,0.12),
                0 4px 16px rgba(59,89,152,0.08);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .status-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .status-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--navy);
        }

        .countdown {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--point-blue);
            margin-bottom: 15px;
        }

        .streak-section {
            margin-bottom: 15px;
        }

        .streak-message {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--point-blue);
            background: rgba(43, 123, 214, 0.08);
            padding: 12px 16px;
            border-radius: 12px;
            border: none;
            text-align: center;
            animation: streakGlow 2s ease-in-out infinite alternate;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .streak-message::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 4s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            25% { left: -100%; }
            100% { left: 100%; }
        }

        .streak-message.title-border {
            border: 3px solid var(--title-color) !important;
            box-shadow: 0 0 20px var(--title-glow);
            background: var(--title-bg);
        }

        @keyframes streakGlow {
            from {
                box-shadow: 0 0 8px rgba(43, 123, 214, 0.3);
            }
            to {
                box-shadow: 0 0 20px rgba(43, 123, 214, 0.5);
            }
        }

        .current-title {
            font-size: 1rem;
            font-weight: 700;
            text-align: center;
            margin-top: 8px;
            padding: 8px 16px;
            border-radius: 10px;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .draw-button {
            background: linear-gradient(135deg, var(--quote-grad-start) 0%, var(--quote-grad-end) 100%);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 16px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(59,89,152,0.25);
            font-family: 'Roboto', sans-serif;
            width: 100%;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .draw-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .draw-button:hover::before {
            left: 100%;
        }

        .draw-button.title-border {
            border: 3px solid var(--title-color) !important;
            box-shadow: 0 6px 20px rgba(59,89,152,0.25), 0 0 20px var(--title-glow);
        }

        .draw-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(59,89,152,0.35);
        }

        .draw-button.title-border:hover {
            box-shadow: 0 8px 25px rgba(59,89,152,0.35), 0 0 25px var(--title-glow);
        }

        .draw-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .titles-button {
            background: linear-gradient(135deg, var(--quote-grad-start) 0%, var(--quote-grad-end) 100%);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 16px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(59,89,152,0.25);
            font-family: 'Roboto', sans-serif;
            width: 100%;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .titles-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .titles-button:hover::before {
            left: 100%;
        }

        .titles-button.title-border {
            border: 3px solid var(--title-color) !important;
            box-shadow: 0 6px 20px rgba(59,89,152,0.25), 0 0 20px var(--title-glow);
        }

        .titles-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(59,89,152,0.35);
        }

        .titles-button.title-border:hover {
            box-shadow: 0 8px 25px rgba(59,89,152,0.35), 0 0 25px var(--title-glow);
        }

        .result-section {
            margin-top: 30px;
        }

        .result-card {
            background: linear-gradient(135deg, var(--quote-grad-start) 0%, var(--quote-grad-end) 100%);
            color: white;
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 15px;
            text-align: left;
            box-shadow: 0 8px 25px rgba(59,89,152,0.25);
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            transition: all 0.6s ease;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 5s infinite;
            animation-delay: 1s;
        }

        .result-card.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .result-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.9;
        }

        .result-content {
            font-size: 1rem;
            line-height: 1.6;
            font-weight: 400;
            font-family: 'Georgia', 'Times New Roman', serif;
            text-align: justify;
        }

        .prayer-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .prayer-subtitle {
            font-size: 0.85rem;
            opacity: 0.8;
            cursor: pointer;
            text-decoration: underline;
            margin-bottom: 10px;
        }

        .prayer-subtitle:hover {
            opacity: 1;
        }

        .drawing-animation {
            background: linear-gradient(135deg, var(--quote-grad-start) 0%, var(--quote-grad-end) 100%);
            color: white;
            border-radius: 18px;
            padding: 25px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(59,89,152,0.25);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .drawing-text {
            font-size: 1.2rem;
            font-weight: 700;
            animation: pulse 0.5s infinite alternate;
        }

        @keyframes pulse {
            from { opacity: 0.7; }
            to { opacity: 1; }
        }

        .icon {
            width: 24px;
            height: 24px;
            background: var(--point-blue);
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        .prayer-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .prayer-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .prayer-modal-content {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80%;
            overflow-y: auto;
            backdrop-filter: blur(25px);
            box-shadow: 0 8px 32px rgba(6,21,52,0.15), 0 4px 16px rgba(255,255,255,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transform: scale(0.8);
            transition: transform 0.3s ease;
            position: relative;
        }

        .prayer-modal.show .prayer-modal-content {
            transform: scale(1);
        }

        .prayer-modal-title {
            font-family: 'Pacifico', cursive;
            font-size: 1.5rem;
            color: var(--navy);
            margin-bottom: 20px;
            text-align: center;
        }

        .prayer-modal-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--navy);
            font-family: 'Georgia', 'Times New Roman', serif;
            text-align: justify;
            white-space: pre-line;
        }

        .close-prayer-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--navy);
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .close-prayer-modal:hover {
            opacity: 1;
        }

        .titles-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .titles-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .titles-content {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80%;
            overflow-y: auto;
            backdrop-filter: blur(25px);
            box-shadow: 0 8px 32px rgba(6,21,52,0.15), 0 4px 16px rgba(255,255,255,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .titles-modal.show .titles-content {
            transform: scale(1);
        }

        .titles-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .titles-header h2 {
            font-family: 'Pacifico', cursive;
            font-size: 2rem;
            color: var(--navy);
            margin-bottom: 10px;
        }

        .titles-subtitle {
            color: var(--navy);
            opacity: 0.8;
        }

        .title-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            box-shadow: 0 4px 16px rgba(6,21,52,0.1), 0 2px 8px rgba(255,255,255,0.1);
        }

        .title-card.unlocked {
            border: 2px solid rgba(34, 197, 94, 0.5);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);
        }

        .title-card.locked {
            opacity: 0.6;
        }

        .title-name {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 8px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .title-icon {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05), 0 1px 4px rgba(255, 255, 255, 0.1);
        }

        .title-icon img {
            width: 24px;
            height: 24px;
            object-fit: cover;
            border-radius: 3px;
        }

        .title-requirement {
            font-size: 0.9rem;
            color: var(--navy);
            opacity: 0.7;
            margin-bottom: 10px;
        }

        .title-progress {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .title-progress-bar {
            height: 100%;
            background: var(--gradient);
            transition: width 0.3s ease;
            border-radius: 8px;
        }

        .title-status {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .title-status.unlocked {
            color: #22c55e;
        }

        .title-status.locked {
            color: #6b7280;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--navy);
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .close-modal:hover {
            opacity: 1;
        }

        @keyframes titlePop {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }
            20% {
                transform: translate(-50%, -50%) scale(1.1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0;
            }
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-10px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 70px 10px 15px 10px;
                max-width: 100%;
            }

            .header {
                padding: 18px;
                margin-bottom: 25px;
            }
            
            .title {
                font-size: 1.9rem;
            }

            .subtitle {
                font-size: 0.9rem;
            }
            
            .card {
                padding: 20px;
                margin-bottom: 15px;
                border-radius: 18px;
            }

            .draw-button, .titles-button {
                padding: 16px 20px;
                font-size: 1rem;
            }

            .result-card {
                padding: 18px;
                margin-bottom: 12px;
            }

            .result-title {
                font-size: 0.95rem;
            }

            .result-content {
                font-size: 1.05rem;
            }

            .streak-message {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .current-title {
                font-size: 0.95rem;
                padding: 8px 16px;
            }

            .history-item {
                padding: 15px;
            }

            .titles-content, .prayer-modal-content {
                padding: 20px;
                width: 95%;
                max-height: 85%;
            }

            .titles-header h2 {
                font-size: 1.6rem;
            }

            .back-arrow {
                width: 45px;
                height: 45px;
                bottom: 25px;
                left: 25px;
            }

            .back-arrow svg {
                width: 22px;
                height: 22px;
            }
        }
    </style>
</head>
<body>
    <a href="https://blogwpg.my.canva.site/" target="_blank" rel="noopener noreferrer" class="back-arrow">
        <svg viewBox="0 0 24 24">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
    </a>
    
    <div class="container">
        <div class="header">
            <h1 class="title">
                Dyskretna Intencja
            </h1>
            <p class="subtitle">Codzienna modlitwa i intencja o p贸nocy</p>
        </div>

        <div class="card">
            <div class="status-section">
                <div id="streakSection" class="streak-section" style="display: none;">
                    <div class="streak-message" id="streakMessage"></div>
                    <div class="current-title" id="currentTitle" style="display: none;"></div>
                </div>
                <div id="countdownSection" class="countdown-section" style="display: none;">
                    <div class="status-title">Nastpne losowanie za:</div>
                    <div class="countdown" id="countdown">adowanie...</div>
                </div>
                <button class="draw-button" id="drawButton" onclick="startDrawing()">
                    Losuj intencj i modlitw
                </button>
            </div>

            <div id="drawingArea"></div>
            <div id="resultsArea"></div>
        </div>

        <div class="card">
            <button class="titles-button" id="titlesButton" onclick="showTitlesModal()">
                 Tytuy Dyskretniaka
            </button>
        </div>
    </div>

    <!-- Modal tytu贸w -->
    <div class="titles-modal" id="titlesModal">
        <div class="titles-content">
            <button class="close-modal" onclick="hideTitlesModal()"></button>
            <div class="titles-header">
                <h2> Tytuy Dyskretniaka</h2>
                <p class="titles-subtitle">Zdobywaj tytuy poprzez codzienn pass modlitwy!</p>
            </div>
            <div id="titlesContainer"></div>
        </div>
    </div>

    <!-- Modal modlitwy -->
    <div class="prayer-modal" id="prayerModal">
        <div class="prayer-modal-content">
            <button class="close-prayer-modal" onclick="hidePrayerModal()"></button>
            <div class="prayer-modal-title" id="prayerModalTitle"></div>
            <div class="prayer-modal-text" id="prayerModalText"></div>
        </div>
    </div>

    <script>
        const prayers = [
            {
                title: "Ojcze nasz",
                text: "Ojcze nasz, kt贸ry jest w niebie,\nwii si Imi Twoje,\nprzyj颅d藕 Kr贸lestwo Twoje,\nbd藕 wola Twoja jako w niebie, tak i na ziemi.\nChleba naszego powszedniego daj nam dzisiaj\ni odpu nam nasze winy,\njako i my odpuszczamy naszym winowajcom.\nI nie w贸d藕 nas na pokuszenie,\nale nas zbaw ode zego. Amen."
            },
            {
                title: "Zdrowa Maryjo",
                text: "Zdrowa Maryjo, aski pena,\nPan z Tob,\nbogosawiona Ty midzy niewiastami\ni bogosawiony owoc 偶ywota Twojego, Jezus.\nwita Maryjo, Matko Bo偶a,\nm贸dl si za nami grzesznymi,\nteraz i w godzin mierci naszej. Amen."
            },
            {
                title: "Chwaa Ojcu",
                text: "Chwaa Ojcu i Synowi, i Duchowi witemu,\njak bya na pocztku, teraz i zawsze,\ni na wieki wiek贸w. Amen."
            },
            {
                title: "Wierz w Boga (Skad Apostolski)",
                text: "Wierz w Boga, Ojca Wszechmogcego,\nStworzyciela nieba i ziemi,\ni w Jezusa Chrystusa, Syna Jego jedynego, Pana naszego,\nkt贸ry si pocz z Ducha witego,\nnarodzi si z Maryi Panny,\numczon pod Ponckim Piatem,\nukrzy偶owan, umar i pogrzebion;\nzstpi do piekie, trzeciego dnia zmartwychwsta;\nwstpi na niebiosa, siedzi po prawicy Boga Ojca Wszechmogcego,\nstamtd przyjdzie sdzi 偶ywych i umarych.\nWierz w Ducha witego,\nwity Koci贸 powszechny,\nwitych obcowanie, grzech贸w odpuszczenie,\nciaa zmartwychwstanie, 偶ywot wieczny. Amen."
            },
            {
                title: "Pod Twoj obron",
                text: "Pod Twoj obron uciekamy si, wita Bo偶a Rodzicielko,\nnaszymi probami racz nie gardzi w potrzebach naszych,\nale od wszelakich zych przyg贸d racz nas zawsze wybawia,\nPanno chwalebna i bogosawiona.\nO Pani nasza, Ordowniczko nasza, Poredniczko nasza, Pocieszycielko nasza,\nSynem swoim nas pojednaj, Synowi swojemu nas polecaj,\nswojemu Synowi nas oddawaj. Amen."
            },
            {
                title: "Aniele Bo偶y, Str贸偶u m贸j",
                text: "Aniele Bo偶y, Str贸偶u m贸j,\nTy zawsze przy mnie st贸j,\nrano, wiecz贸r, we dnie, w nocy,\nbd藕 mi zawsze ku pomocy.\nStrze偶 duszy, ciaa mego,\nzaprowad藕 mnie do 偶ywota wiecznego. Amen."
            },
            {
                title: "Modlitwa do Ducha witego",
                text: "Duchu wity, przyjd藕,\nnapenij serca swoich wiernych\ni zapal w nich ogie swojej mioci.\nZelij Ducha swego, a powstanie 偶ycie,\ni odnowisz oblicze ziemi. Amen."
            },
            {
                title: "Jezu, ufam Tobie",
                text: "Jezu, ufam Tobie!"
            },
            {
                title: "wity Bo偶e",
                text: "wity Bo偶e, wity mocny,\nwity a Niemiertelny,\nzmiuj si nad nami i nad caym wiatem."
            },
            {
                title: "Baranku Bo偶y",
                text: "Baranku Bo偶y, kt贸ry gadzisz grzechy wiata,\nzmiuj si nad nami.\nBaranku Bo偶y, kt贸ry gadzisz grzechy wiata,\nzmiuj si nad nami.\nBaranku Bo偶y, kt贸ry gadzisz grzechy wiata,\nobdarz nas pokojem."
            },
            {
                title: "Panie, nie jestem godzien",
                text: "Panie, nie jestem godzien,\naby przyszed do mnie,\nale powiedz tylko sowo,\na bdzie uzdrowiona dusza moja."
            },
            {
                title: "O Krwi i Wodo",
                text: "O Krwi i Wodo, kt贸ra wypyna\nz Najwitszego Serca Jezusowego\njako zdr贸j miosierdzia dla nas,\nufam Tobie."
            },
            {
                title: "Bo偶e, bd藕 miociw mnie grzesznemu",
                text: "Bo偶e, bd藕 miociw mnie grzesznemu!"
            },
            {
                title: "wity, wity, wity Pan B贸g Zastp贸w",
                text: "wity, wity, wity Pan B贸g Zastp贸w.\nPene s niebiosa i ziemia chway Twojej.\nHosanna na wysokoci!"
            },
            {
                title: "Serce Jezusa, ufam Tobie",
                text: "Serce Jezusa, ufam Tobie!"
            },
            {
                title: "Apel Jasnog贸rski",
                text: "Maryjo, Kr贸lowo Polski,\njestem przy Tobie, pamitam, czuwam."
            }
        ];

        const intentions = [
            "Za ksidza proboszcza i wszystkich ksi偶y z naszej parafii",
            "Za losow osob korzystajc z aplikacji Dyskretna Intencja",
            "Za dusze cierpice w Czycu",
            "Za pok贸j na wiecie i w naszych sercach",
            "Za chorych i cierpicych w naszej wsp贸lnocie",
            "Za jedno rodzin i ma偶estw",
            "Za modzie偶 i ich przyszo",
            "Za osoby samotne i opuszczone",
            "Za nawr贸cenie grzesznik贸w",
            "Za kapan贸w i osoby konsekrowane",
            "Za rodzic贸w i dzieci",
            "Za bezrobotnych i potrzebujcych",
            "Za pok贸j w rodzinach",
            "Za osoby w depresji i smutku",
            "Za misjonarzy na caym wiecie",
            "Za papie偶a i hierarchi Kocioa",
            "Za osoby uzale偶nione i ich rodziny",
            "Za dzieci nienarodzonych",
            "Za osoby starsze i samotne",
            "Za jedno chrzecijan",
            "Za przeladowanych za wiar",
            "Za osoby poszukujce Boga",
            "Za nauczycieli i wychowawc贸w",
            "Za lekarzy i su偶b zdrowia",
            "Za pok贸j midzy narodami",
            "Za ochron rodowiska naturalnego",
            "Za osoby w 偶aobie",
            "Za wi藕ni贸w i ich rodziny",
            "Za osoby bezdomne",
            "Za wszystkich wiernych zmarych"
        ];

        // Funkcja bezpiecznego adowania danych z localStorage
        function loadData() {
            try {
                lastDrawDate = localStorage.getItem('lastDrawDate');
                todaysPrayer = localStorage.getItem('todaysPrayer');
                todaysIntention = localStorage.getItem('todaysIntention');
                const historyData = localStorage.getItem('drawHistory');
                drawHistory = historyData ? JSON.parse(historyData) : [];
                
                // Zaaduj pass
                currentStreak = parseInt(localStorage.getItem('currentStreak') || '0');
                lastStreakDate = localStorage.getItem('lastStreakDate');
                
                // Zaaduj zdobyte tytuy
                const unlockedTitlesData = localStorage.getItem('unlockedTitles');
                unlockedTitles = unlockedTitlesData ? JSON.parse(unlockedTitlesData) : [];
                
                // Sprawd藕 czy passa si nie zerwaa (ale tylko jeli mino wicej ni偶 2 dni)
                checkStreakContinuity();
                
                console.log('Zaadowane dane:', {
                    lastDrawDate,
                    todaysPrayer: todaysPrayer ? 'tak' : 'nie',
                    todaysIntention: todaysIntention ? 'tak' : 'nie',
                    historyLength: drawHistory.length,
                    currentStreak,
                    unlockedTitles: unlockedTitles.length
                });
            } catch (e) {
                console.log('Bd adowania danych:', e);
                drawHistory = [];
                currentStreak = 0;
                unlockedTitles = [];
            }
        }

        let lastDrawDate, todaysPrayer, todaysIntention, drawHistory, currentStreak, lastStreakDate, unlockedTitles;
        
        // Zaaduj dane przy starcie
        loadData();

        function checkStreakContinuity() {
            if (!lastStreakDate) return;
            
            const today = new Date();
            const lastDate = new Date(lastStreakDate);
            const diffTime = Math.abs(today - lastDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            // Jeli mino wicej ni偶 2 dni, zresetuj pass (dajemy 1 dzie tolerancji)
            if (diffDays > 2) {
                currentStreak = 0;
                console.log('Passa zresetowana - mino wicej ni偶 48h');
            }
        }

        const titles = [
            { days: 2, name: "Nowicjusz", gradient: "linear-gradient(135deg, #22c55e, #16a34a)", borderColor: "#22c55e", glowColor: "rgba(34, 197, 94, 0.3)", icon: "zdjcie_1.png", unlocked: false },
            { days: 5, name: "Ucze Wytrwaoci", gradient: "linear-gradient(135deg, #3b82f6, #1d4ed8)", borderColor: "#3b82f6", glowColor: "rgba(59, 130, 246, 0.3)", icon: "zdjcie_2.png", unlocked: false },
            { days: 10, name: "Wytrway Praktykant", gradient: "linear-gradient(135deg, #ec4899, #be185d)", borderColor: "#ec4899", glowColor: "rgba(236, 72, 153, 0.3)", icon: "zdjcie_3.png", unlocked: false },
            { days: 15, name: "Ogarnity Dyskretniak", gradient: "linear-gradient(135deg, #f97316, #ea580c)", borderColor: "#f97316", glowColor: "rgba(249, 115, 22, 0.3)", icon: "zdjcie_4.png", unlocked: false },
            { days: 20, name: "Mistrz Rutyny", gradient: "linear-gradient(135deg, #8b5cf6, #7c3aed)", borderColor: "#8b5cf6", glowColor: "rgba(139, 92, 246, 0.3)", icon: "zdjcie_5.png", unlocked: false },
            { days: 25, name: "wiato Dyskrecji", gradient: "linear-gradient(135deg, #ef4444, #dc2626)", borderColor: "#ef4444", glowColor: "rgba(239, 68, 68, 0.3)", icon: "zdjcie_6.png", unlocked: false },
            { days: 30, name: "Duchowny Weteran", gradient: "linear-gradient(135deg, #fbbf24, #f59e0b)", borderColor: "#fbbf24", glowColor: "rgba(251, 191, 36, 0.3)", icon: "zdjcie_7.png", unlocked: false }
        ];

        function updateStreak() {
            const today = new Date().toDateString();
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toDateString();
            
            // Jeli to pierwsze losowanie lub losowanie nastpnego dnia po poprzednim
            if (!lastStreakDate || lastStreakDate === yesterdayStr) {
                currentStreak++;
            } else if (lastStreakDate !== today) {
                // Jeli bya przerwa, zresetuj pass
                currentStreak = 1;
            }
            
            lastStreakDate = today;
            
            // Sprawd藕 czy odblokowano nowe tytuy
            checkNewTitles();
        }

        function checkNewTitles() {
            titles.forEach(title => {
                if (currentStreak >= title.days && !unlockedTitles.includes(title.name)) {
                    unlockedTitles.push(title.name);
                    showTitleUnlocked(title);
                }
            });
            
            // Aktualizuj wygld przycisk贸w po zdobyciu nowych tytu贸w
            updateDrawButton();
            updateTitlesButton();
            showStreak();
        }

        function showTitleUnlocked(title) {
            // Uruchom confetti w kolorze tytuu
            createConfetti(title.borderColor);
            
            // Poka偶 powiadomienie o nowym tytule
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: ${title.gradient};
                color: white;
                padding: 20px 30px;
                border-radius: 12px;
                font-weight: 700;
                font-size: 1.2rem;
                z-index: 10000;
                box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                animation: titlePop 3s ease-out forwards;
            `;
            notification.innerHTML = ` Nowy tytu odblokowany!<br>"${title.name}"`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function createConfetti(color) {
            const confettiCount = 50;
            const colors = [color, '#ffffff', '#ffd700']; // G贸wny kolor + biay + zoty
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    confetti.style.cssText = `
                        position: fixed;
                        width: 10px;
                        height: 10px;
                        background: ${randomColor};
                        top: -10px;
                        left: ${Math.random() * 100}%;
                        z-index: 9999;
                        border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                        animation: confettiFall ${2 + Math.random() * 3}s linear forwards;
                        transform: rotate(${Math.random() * 360}deg);
                    `;
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }, i * 50);
            }
        }

        function getStreakMessage() {
            if (currentStreak === 0) return '';
            if (currentStreak === 1) return ' Pierwszy dzie modlitwy!';
            if (currentStreak < 7) return ` Passa: ${currentStreak} dni z rzdu!`;
            if (currentStreak < 30) return `ヰ wietna passa: ${currentStreak} dni!`;
            if (currentStreak < 100) return `ヰヰ Niesamowita passa: ${currentStreak} dni!`;
            return `ヰヰヰ Legendarna passa: ${currentStreak} dni!`;
        }

        function updateCountdown() {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(0, 0, 0, 0);
            
            const timeLeft = tomorrow - now;
            
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('countdown').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function canDrawToday() {
            const today = new Date().toDateString();
            return lastDrawDate !== today;
        }

        function updateDrawButton() {
            const button = document.getElementById('drawButton');
            const highestTitle = getHighestUnlockedTitle();
            
            if (canDrawToday()) {
                button.disabled = false;
                button.textContent = 'Losuj intencj i modlitw';
            } else {
                button.disabled = true;
                button.textContent = 'Ju偶 losowae dzisiaj';
            }
            
            if (highestTitle) {
                button.className = 'draw-button title-border';
                button.style.setProperty('--title-color', highestTitle.borderColor);
                button.style.setProperty('--title-glow', highestTitle.glowColor);
            } else {
                button.className = 'draw-button';
            }
        }

        function getHighestUnlockedTitle() {
            let highestTitle = null;
            titles.forEach(title => {
                if (unlockedTitles.includes(title.name)) {
                    if (!highestTitle || title.days > highestTitle.days) {
                        highestTitle = title;
                    }
                }
            });
            return highestTitle;
        }

        function showTodaysResults() {
            const today = new Date().toDateString();
            if (lastDrawDate === today && todaysPrayer && todaysIntention) {
                const resultsArea = document.getElementById('resultsArea');
                
                // Znajd藕 obiekt modlitwy na podstawie tytuu
                const prayerObj = prayers.find(p => p.title === todaysPrayer) || { title: todaysPrayer, text: todaysPrayer };
                
                resultsArea.innerHTML = `
                    <div class="result-card show">
                        <div class="result-title">
                            <div class="icon"></div>
                            Dzisiejsza intencja
                        </div>
                        <div class="result-content">${todaysIntention}</div>
                    </div>
                    <div class="result-card show">
                        <div class="result-title">
                            <div class="icon"></div>
                            Dzisiejsza modlitwa
                        </div>
                        <div class="result-content">
                            <div class="prayer-title">${prayerObj.title}</div>
                            <div class="prayer-subtitle" onclick="showPrayerModal('${prayerObj.title}', \`${prayerObj.text}\`)">nacinij aby wywietli peny tekst</div>
                        </div>
                    </div>
                `;
                showCountdown();
                showStreak();
            }
        }

        function showStreak() {
            const streakMessage = getStreakMessage();
            if (streakMessage) {
                const streakElement = document.getElementById('streakMessage');
                const titleElement = document.getElementById('currentTitle');
                const highestTitle = getHighestUnlockedTitle();
                
                document.getElementById('streakSection').style.display = 'block';
                streakElement.textContent = streakMessage;
                
                if (highestTitle) {
                    streakElement.className = 'streak-message title-border';
                    streakElement.style.setProperty('--title-color', highestTitle.borderColor);
                    streakElement.style.setProperty('--title-glow', highestTitle.glowColor);
                    streakElement.style.setProperty('--title-bg', highestTitle.borderColor + '15');
                    
                    // Poka偶 aktualny tytu
                    titleElement.textContent = highestTitle.name;
                    titleElement.style.background = highestTitle.gradient;
                    titleElement.style.webkitBackgroundClip = 'text';
                    titleElement.style.webkitTextFillColor = 'transparent';
                    titleElement.style.backgroundClip = 'text';
                    titleElement.style.display = 'block';
                } else {
                    streakElement.className = 'streak-message';
                    titleElement.style.display = 'none';
                }
            }
        }

        function showCountdown() {
            document.getElementById('countdownSection').style.display = 'block';
        }

        function showPrayerModal(title, text) {
            document.getElementById('prayerModalTitle').textContent = title;
            document.getElementById('prayerModalText').textContent = text;
            document.getElementById('prayerModal').classList.add('show');
        }

        function hidePrayerModal() {
            document.getElementById('prayerModal').classList.remove('show');
        }

        function startDrawing() {
            if (!canDrawToday()) {
                return;
            }

            const drawingArea = document.getElementById('drawingArea');
            const resultsArea = document.getElementById('resultsArea');
            
            resultsArea.innerHTML = '';
            
            // Najpierw losowanie intencji
            drawingArea.innerHTML = `
                <div class="drawing-animation">
                    <div class="drawing-text" id="drawingText">Losuj intencj...</div>
                </div>
            `;

            const intentionOptions = [...intentions];
            let intentionIndex = 0;
            const intentionInterval = setInterval(() => {
                document.getElementById('drawingText').textContent = intentionOptions[intentionIndex % intentionOptions.length];
                intentionIndex++;
            }, 100);

            setTimeout(() => {
                clearInterval(intentionInterval);
                const selectedIntention = intentions[Math.floor(Math.random() * intentions.length)];
                
                // Potem losowanie modlitwy
                drawingArea.innerHTML = `
                    <div class="drawing-animation">
                        <div class="drawing-text" id="drawingText2">Losuj modlitw...</div>
                    </div>
                `;

                const prayerOptions = prayers.map(p => p.title);
                let prayerIndex = 0;
                const prayerInterval = setInterval(() => {
                    document.getElementById('drawingText2').textContent = prayerOptions[prayerIndex % prayerOptions.length];
                    prayerIndex++;
                }, 100);

                setTimeout(() => {
                    clearInterval(prayerInterval);
                    const selectedPrayer = prayers[Math.floor(Math.random() * prayers.length)];
                    
                    drawingArea.innerHTML = '';
                    
                    // Zapisz wyniki
                    const today = new Date().toDateString();
                    lastDrawDate = today;
                    todaysPrayer = selectedPrayer.title;
                    todaysIntention = selectedIntention;
                    
                    // Aktualizuj pass
                    updateStreak();
                    
                    // Dodaj do historii
                    drawHistory.unshift({
                        date: today,
                        prayer: selectedPrayer.title,
                        intention: selectedIntention,
                        streak: currentStreak
                    });
                    
                    if (drawHistory.length > 10) {
                        drawHistory = drawHistory.slice(0, 10);
                    }
                    
                    // Zapisz wszystko do localStorage
                    saveAllData();
                    
                    // Poka偶 wyniki - najpierw intencja, potem modlitwa
                    resultsArea.innerHTML = `
                        <div class="result-card">
                            <div class="result-title">
                                <div class="icon"></div>
                                Twoja dzisiejsza intencja
                            </div>
                            <div class="result-content">${selectedIntention}</div>
                        </div>
                        <div class="result-card">
                            <div class="result-title">
                                <div class="icon"></div>
                                Twoja dzisiejsza modlitwa
                            </div>
                            <div class="result-content">
                                <div class="prayer-title">${selectedPrayer.title}</div>
                                <div class="prayer-subtitle" onclick="showPrayerModal('${selectedPrayer.title}', \`${selectedPrayer.text}\`)">nacinij aby wywietli peny tekst</div>
                            </div>
                        </div>
                    `;
                    
                    setTimeout(() => {
                        document.querySelectorAll('.result-card').forEach(card => {
                            card.classList.add('show');
                        });
                    }, 100);
                    
                    updateDrawButton();
                    showCountdown();
                    showStreak();
                }, 3000);
            }, 3000);
        }

        // Inicjalizacja - zaaduj dane ponownie i wywietl
        window.addEventListener('load', function() {
            loadData();
            updateDrawButton();
            updateTitlesButton();
            showTodaysResults();
        });
        
        // Uruchom inicjalizacj od razu
        updateDrawButton();
        updateTitlesButton();
        showTodaysResults();
        showStreak();
        
        setInterval(updateCountdown, 1000);
        
        // Sprawd藕 o p贸nocy czy mo偶na losowa i zapisuj dane regularnie
        setInterval(() => {
            const now = new Date();
            if (now.getHours() === 0 && now.getMinutes() === 0) {
                updateDrawButton();
            }
            // Zapisuj dane co minut dla pewnoci
            saveAllData();
        }, 60000);

        function updateTitlesButton() {
            const button = document.getElementById('titlesButton');
            const highestTitle = getHighestUnlockedTitle();
            
            if (highestTitle) {
                button.className = 'titles-button title-border';
                button.style.setProperty('--title-color', highestTitle.borderColor);
                button.style.setProperty('--title-glow', highestTitle.glowColor);
            } else {
                button.className = 'titles-button';
            }
        }

        function showTitlesModal() {
            updateTitlesDisplay();
            document.getElementById('titlesModal').classList.add('show');
        }

        function hideTitlesModal() {
            document.getElementById('titlesModal').classList.remove('show');
        }

        function updateTitlesDisplay() {
            const container = document.getElementById('titlesContainer');
            
            container.innerHTML = titles.map(title => {
                const isUnlocked = unlockedTitles.includes(title.name);
                const progress = Math.min((currentStreak / title.days) * 100, 100);
                
                return `
                    <div class="title-card ${isUnlocked ? 'unlocked' : 'locked'}" style="--gradient: ${title.gradient}">
                        <div class="title-name" style="background: ${title.gradient}; -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                            <div class="title-icon">
                                <img src="${title.icon}" alt="${title.name}" onerror="this.style.display='none';">
                            </div>
                            ${title.name}
                        </div>
                        <div class="title-requirement">
                            Wymagane: ${title.days} dni passy
                        </div>
                        <div class="title-progress">
                            <div class="title-progress-bar" style="width: ${progress}%; background: ${title.gradient}"></div>
                        </div>
                        <div class="title-status ${isUnlocked ? 'unlocked' : 'locked'}">
                            ${isUnlocked ? ' Odblokowany!' : `${currentStreak}/${title.days} dni`}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Zamknij modal po klikniciu w to
        document.getElementById('titlesModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideTitlesModal();
            }
        });

        document.getElementById('prayerModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hidePrayerModal();
            }
        });

        // Zapisuj dane przy ka偶dej zmianie
        function saveAllData() {
            try {
                localStorage.setItem('lastDrawDate', lastDrawDate || '');
                localStorage.setItem('todaysPrayer', todaysPrayer || '');
                localStorage.setItem('todaysIntention', todaysIntention || '');
                localStorage.setItem('drawHistory', JSON.stringify(drawHistory || []));
                localStorage.setItem('currentStreak', currentStreak.toString());
                localStorage.setItem('lastStreakDate', lastStreakDate || '');
                localStorage.setItem('unlockedTitles', JSON.stringify(unlockedTitles || []));
                
                console.log('Zapisano dane:', {
                    lastDrawDate,
                    todaysPrayer: todaysPrayer ? 'tak' : 'nie',
                    todaysIntention: todaysIntention ? 'tak' : 'nie',
                    historyLength: drawHistory ? drawHistory.length : 0,
                    currentStreak,
                    lastStreakDate,
                    unlockedTitles: unlockedTitles.length
                });
            } catch (e) {
                console.log('Bd zapisywania danych:', e);
            }
        }

        // Zapisuj dane przed zamkniciem strony
        window.addEventListener('beforeunload', saveAllData);
        window.addEventListener('pagehide', saveAllData);
        
        // Zapisuj dane przy ka偶dej aktywnoci u偶ytkownika
        document.addEventListener('click', saveAllData);
        document.addEventListener('keydown', saveAllData);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9910580873835779',t:'MTc2MDg3NzYyNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
